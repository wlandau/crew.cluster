<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Crew Launcher Plugins for Traditional High-Performance Computing
  Clusters • crew.cluster</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Crew Launcher Plugins for Traditional High-Performance Computing
  Clusters">
<meta property="og:description" content="In computationally demanding analysis projects,
  statisticians and data scientists asynchronously
  deploy long-running tasks to distributed systems,
  ranging from traditional clusters to cloud services.
  The crew.cluster package extends the mirai-powered
  crew package with worker launcher plugins for traditional
  high-performance computing systems.
  Inspiration also comes from packages mirai by Gao (2023)
  &lt;https://github.com/shikokuchuo/mirai&gt;,
  future by Bengtsson (2021) &lt;doi:10.32614/RJ-2021-048&gt;,
  rrq by FitzJohn and Ashton (2023) &lt;https://github.com/mrc-ide/rrq&gt;,
  clustermq by Schubert (2019) &lt;doi:10.1093/bioinformatics/btz284&gt;),
  and batchtools by Lang, Bischl, and Surmann (2017).
  &lt;doi:10.21105/joss.00135&gt;.">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">crew.cluster</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wlandau/crew.cluster/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="crewcluster-crew-launcher-plugins-for-traditional-high-performance-computing-clusters-">crew.cluster: crew launcher plugins for traditional high-performance computing clusters <img src="reference/figures/logo-readme.png" align="right" height="139"><a class="anchor" aria-label="anchor" href="#crewcluster-crew-launcher-plugins-for-traditional-high-performance-computing-clusters-"></a>
</h1></div>
<p><a href="https://CRAN.R-project.org/package=crew.cluster" class="external-link"><img src="https://www.r-pkg.org/badges/version/crew.cluster" alt="CRAN"></a> <a href="https://www.repostatus.org/#Active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="status"></a> <a href="https://github.com/wlandau/crew.cluster/actions?query=workflow%3Acheck" class="external-link"><img src="https://github.com/wlandau/crew.cluster/workflows/check/badge.svg" alt="check"></a> <a href="https://app.codecov.io/gh/wlandau/crew.cluster" class="external-link"><img src="https://codecov.io/gh/wlandau/crew.cluster/branch/main/graph/badge.svg?token=3T5DlLwUVl" alt="codecov"></a> <a href="https://github.com/wlandau/crew.cluster/actions?query=workflow%3Alint" class="external-link"><img src="https://github.com/wlandau/crew.cluster/workflows/lint/badge.svg" alt="lint"></a></p>
<p>In computationally demanding analysis projects, statisticians and data scientists asynchronously deploy long-running tasks to distributed systems, ranging from traditional clusters to cloud services. The <code>crew.cluster</code> package extends the <a href="https://github.com/shikokuchuo/mirai" class="external-link"><code>mirai</code></a>-powered ‘crew’ package with worker launcher plugins for traditional high-performance computing systems. Inspiration also comes from packages <a href="https://github.com/shikokuchuo/mirai" class="external-link"><code>mirai</code></a>, <a href="https://future.futureverse.org/" class="external-link"><code>future</code></a>, <a href="https://mrc-ide.github.io/rrq/" class="external-link"><code>rrq</code></a>, <a href="https://mschubert.github.io/clustermq/" class="external-link"><code>clustermq</code></a>, and <a href="https://mllg.github.io/batchtools/" class="external-link"><code>batchtools</code></a>.</p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<table class="table">
<colgroup>
<col width="13%">
<col width="12%">
<col width="75%">
</colgroup>
<thead><tr class="header">
<th>Type</th>
<th>Source</th>
<th>Command</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Release</td>
<td>CRAN</td>
<td><code>install.packages("crew.cluster")</code></td>
</tr>
<tr class="even">
<td>Development</td>
<td>GitHub</td>
<td><code>remotes::install_github("wlandau/crew.cluster")</code></td>
</tr>
<tr class="odd">
<td>Development</td>
<td>R-universe</td>
<td><code>install.packages("crew", repos = "https://crew.cluster.r-universe.dev")</code></td>
</tr>
</tbody>
</table>
</div>
<div class="section level1">
<h1 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h1>
<p>Please see <a href="https://wlandau.github.io/crew.cluster/" class="external-link uri">https://wlandau.github.io/crew.cluster/</a> for documentation, including a full function reference and usage tutorial.</p>
</div>
<div class="section level1">
<h1 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h1>
<p>First, create a controller object appropriate for your platform. For example, to launch workers on a Sun Grid Engine (SGE) cluster, use <code><a href="reference/crew_controller_sge.html">crew_controller_sge()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wlandau.github.io/crew.cluster/" class="external-link">crew.cluster</a></span><span class="op">)</span></span>
<span><span class="va">controller</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/crew_controller_sge.html">crew_controller_sge</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"my_workflow"</span>, <span class="co"># for informative job names</span></span>
<span>  workers <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  tasks_max <span class="op">=</span> <span class="fl">2</span>, <span class="co"># to avoid reaching wall time limits</span></span>
<span>  seconds_idle <span class="op">=</span> <span class="fl">10</span>, <span class="co"># to release resources when they are not needed</span></span>
<span>  script_lines <span class="op">=</span> <span class="st">"module load R"</span> <span class="co"># if R is an environment module</span></span>
<span><span class="op">)</span></span>
<span><span class="va">controller</span><span class="op">$</span><span class="fu">start</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>At this point, usage is exactly the same as basic <a href="https://wlandau.github.io/crew" class="external-link"><code>crew</code></a>. The <code>push()</code> method submits tasks and auto-scales SGE workers to meet demand.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">controller</span><span class="op">$</span><span class="fu">push</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"do work"</span>, command <span class="op">=</span> <span class="fu">do_work</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The <code>pop()</code> method retrieves available tasks.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">controller</span><span class="op">$</span><span class="fu">pop</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 11</span></span>
<span><span class="co">#&gt;   name         command result seconds   seed error trace warni…¹ launc…² worker insta…³</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;chr&gt;   &lt;list&gt;   &lt;dbl&gt;  &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;  </span></span>
<span><span class="co">#&gt; 1 do work   … do_work… &lt;int&gt;        0 1.56e8 NA    NA    NA      79e71c…      1 7686b2…</span></span>
<span><span class="co">#&gt; # … with abbreviated variable names ¹​warnings, ²​launcher, ³​instance</span></span></code></pre></div>
<p>Remember to terminate the controller when you are done.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">controller</span><span class="op">$</span><span class="fu">terminate</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="tips">Tips<a class="anchor" aria-label="anchor" href="#tips"></a>
</h1>
<ul>
<li>
<code>crew.cluster</code> submits jobs over the local network using system calls to the resource manager (e.g SGE or SLURM). Please invoke <code>crew.cluster</code> on a node of the cluster, either a login node (head node) or a compute node.</li>
<li>Most clusters install software like R in versioned environment modules. Most likely, you will need to call <code>module load R</code> (or <code>module load R/x.y.z</code> for a specific version) in order to use on the cluster. In <code>crew.cluster</code>, you will most likely need to supply <code>"module load R"</code> or similar to the <code>script_lines</code> argument of e.g. <code><a href="reference/crew_controller_sge.html">crew_controller_sge()</a></code>.</li>
</ul>
</div>
<div class="section level1">
<h1 id="risks">Risks<a class="anchor" aria-label="anchor" href="#risks"></a>
</h1>
<p>The risks of <code>crew.cluster</code> are the same as <a href="https://wlandau.github.io/crew/#risks" class="external-link">those of <code>crew</code></a>, plus the risks of traditional high-performance computing environments. These distributed systems typically operate inside a firewall and trust the local network. It is your responsibility to assess the security of these systems and use <code>crew.cluster</code> in a safe manner. In addition, <code>crew.cluster</code> automatically launches jobs on the cluster scheduler, and it may not always be able to terminate leftover jobs. It is your responsibility to monitor your jobs an manually terminate jobs that <code>crew.cluster</code> may not be able to.</p>
</div>
<div class="section level1">
<h1 id="thanks">Thanks<a class="anchor" aria-label="anchor" href="#thanks"></a>
</h1>
<ul>
<li>
<a href="https://github.com/shikokuchuo" class="external-link">Charlie Gao</a> created <a href="https://github.com/shikokuchuo/mirai" class="external-link"><code>mirai</code></a> and <a href="https://github.com/shikokuchuo/nanonext" class="external-link"><code>nanonext</code></a> and graciously accommodated the complicated and demanding feature requests that made <code>crew</code> and its ecosystem possible.</li>
<li>Thanks to <a href="https://github.com/mschubert" class="external-link">Michael Schubert</a> for sharing the <a href="https://github.com/mschubert/clustermq/tree/master/inst" class="external-link">template files</a> in <a href="https://github.com/mschubert/clustermq" class="external-link"><code>clustermq</code></a> with the permissive <a href="https://github.com/mschubert/clustermq/blob/master/LICENSE" class="external-link">Apache License 2.0</a>. These scripts helped construct launcher plugins to clusters where direct access was not possible. See the <a href="https://github.com/wlandau/crew.cluster/blob/main/NOTICE" class="external-link"><code>NOTICE</code></a> file in this package.</li>
</ul>
</div>
<div class="section level1">
<h1 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h1>
<p>Please note that the <code>crew</code> project is released with a <a href="https://github.com/wlandau/crew/blob/main/CODE_OF_CONDUCT.md" class="external-link">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
<div class="section level1">
<h1 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h1>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"crew.cluster"</span><span class="op">)</span></span></code></pre></div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=crew.cluster" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/wlandau/crew.cluster/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/wlandau/crew.cluster/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing crew.cluster</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>William Michael Landau <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-1878-3253" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Michael Gilbert Levin <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-9937-9932" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by William Michael Landau, Michael Gilbert Levin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
